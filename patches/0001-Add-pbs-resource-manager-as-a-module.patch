From 5206f6ecb58f124ec0f1807af76f784086242ca1 Mon Sep 17 00:00:00 2001
From: Utkarsh <utkarsh.maheshwari@altair.com>
Date: Wed, 29 Aug 2018 19:09:01 +0530
Subject: [PATCH 1/3] Add pbs resource manager as a module

---
 .travis.yml                                                    |  2 +-
 assembly/pom.xml                                               | 10 ++++++++++
 .../java/org/apache/spark/launcher/AbstractCommandBuilder.java |  1 +
 pom.xml                                                        |  7 +++++++
 4 files changed, 19 insertions(+), 1 deletion(-)

diff --git a/.travis.yml b/.travis.yml
index 05b94ade..0d053ae 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -43,7 +43,7 @@ notifications:
 # 5. Run maven install before running lint-java.
 install:
   - export MAVEN_SKIP_RC=1
-  - build/mvn -T 4 -q -DskipTests -Pkubernetes -Pmesos -Pyarn -Pkinesis-asl -Phive -Phive-thriftserver install
+  - build/mvn -T 4 -q -DskipTests -Pkubernetes -Ppbs -Pmesos -Pyarn -Pkinesis-asl -Phive -Phive-thriftserver install
 
 # 6. Run lint-java.
 script:
diff --git a/assembly/pom.xml b/assembly/pom.xml
index d431d3f..98616a2 100644
--- a/assembly/pom.xml
+++ b/assembly/pom.xml
@@ -149,6 +149,16 @@
       </dependencies>
     </profile>
     <profile>
+      <id>pbs</id>
+      <dependencies>
+        <dependency>
+          <groupId>org.apache.spark</groupId>
+          <artifactId>spark-pbs_${scala.binary.version}</artifactId>
+          <version>${project.version}</version>
+        </dependency>
+      </dependencies>
+    </profile>
+    <profile>
       <id>kubernetes</id>
       <dependencies>
         <dependency>
diff --git a/launcher/src/main/java/org/apache/spark/launcher/AbstractCommandBuilder.java b/launcher/src/main/java/org/apache/spark/launcher/AbstractCommandBuilder.java
index ce24400..6e74368 100644
--- a/launcher/src/main/java/org/apache/spark/launcher/AbstractCommandBuilder.java
+++ b/launcher/src/main/java/org/apache/spark/launcher/AbstractCommandBuilder.java
@@ -159,6 +159,7 @@ abstract class AbstractCommandBuilder {
         "repl",
         "resource-managers/mesos",
         "resource-managers/yarn",
+        "resource-managers/pbs",
         "sql/catalyst",
         "sql/core",
         "sql/hive",
diff --git a/pom.xml b/pom.xml
index 099a081..86b7830 100644
--- a/pom.xml
+++ b/pom.xml
@@ -2721,6 +2721,13 @@
     </profile>
 
     <profile>
+      <id>pbs</id>
+      <modules>
+        <module>resource-managers/pbs</module>
+      </modules>
+    </profile>
+
+    <profile>
       <id>hive-thriftserver</id>
       <modules>
         <module>sql/hive-thriftserver</module>
-- 
2.7.4

